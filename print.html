<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <style>
      body {
        background-color: #32acc8;
        position: relative; /* Make the body position relative to allow absolute positioning */
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
      }
      input {
        width: 40%;
        padding: 12px 20px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #000;
        border-radius: 4px;
        box-sizing: border-box;
      }
      table {
        font-family: times;
        border-collapse: collapse;
        width: 90%;
        color: #97d7e8;
      }
      td, th {
        border: 1px solid #000;
        text-align: left;
        padding: 8px;
      }
      tr, th:nth-child(even) {
        background-color: #e0e0e0;
        color: #000;
      }
      h2 {
        color: #000;
        margin-top: 10px;
        font-size: 25px;
        font-weight: bold;
      }
      .btn {
        width: 25%;
      }
      #PrintDiv {
        margin-top: 20px;
      }
     
      .return-btn:hover {
        background-color: #c9302c; /* Darker red when hovering */
      }
      footer {
      position: variable;
      bottom: 0;            /* Positions the footer at the bottom */
      width: 100%;          /* Ensures it stretches across the entire width */
      text-align: center;   /* Center the footer text */
      padding: 10px 0;      /* Adds space around the footer content */
      background-color: #f1f1f1;
      font-size: 12px;      /* Smaller font for copyright text */
    }
     /* Navbar styling */
      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #333;
        padding: 2px 8px;
        color: white;
  		top: 0; /* Align it to the top */
      }

      
      .navbar .logo {
        font-size: 20px;
        font-weight: bold;
        color: white;
      }

      .navbar .logo img {
        max-height: 40px;
        vertical-align: middle;
      }

      .navbar .nav-links {
        display: flex;
        align-items: center;
        justify-content: flex-start; /* Left-align the nav items */
        flex: 1;
      }

      .navbar button, .navbar a {
        background-color: transparent;
        color: white;
        border: none;
        font-size: 16px;
        cursor: pointer;
        text-decoration: none;
        margin-left: 15px;
        padding: 8px 15px;
      }

      .navbar a:hover, .navbar button:hover {
        text-decoration: underline;
        box-shadow: 0 0 5px 2px yellow; /* Yellow box on hover */
      }

      .navbar .user-profile {
  display: flex;
  align-items: center;
  padding: 5px 10px; /* Reduce height */
  border-radius: 5px; /* Optional: rounded edges */
}

.navbar .user-profile a {
  display: flex;
  align-items: center;
  text-decoration: none;
  padding: 5px; /* Reduce height */
}

.navbar .user-profile img {
  max-width: 35px; /* Slightly smaller */
  vertical-align: middle;
}

.navbar .user-profile span {
  display: flex;
  align-items: center;
  margin-left: 8px;
  font-size: 16px;
  line-height: normal;
}

/* Add an outline on hover for the logo */
.navbar .logo img {
  transition: outline 0.3s ease-in-out;
}

.navbar .logo img:hover {
  outline: 3px solid yellow;
  border-radius: 5px;
}
 	.sign-out-btn {
        padding: 10px 20px;
        background-color: #EE4B2B !important; /* Red background */
        color: white;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 5px;
      }

      .sign-out-btn:hover {
        background-color: #EE4B2B !important; /* Keep the red color even on hover */
      }
/* Hide the hamburger menu on large screens */
.hamburger-menu {
  display: none;
  font-size: 30px;
  cursor: pointer;
  padding: 10px;
  background-color: transparent;
  border: none;
  color: white;
}

/* Make the nav-links hidden on small screens */
@media screen and (max-width: 768px) {
  .navbar {
    flex-direction: row;
    align-items: center;
    position: relative;
  }

  .hamburger-menu {
    display: block;
    background: none;
    border: none;
    font-size: 60px;
    color: white;
    cursor: pointer;
    margin-left: 10px;
  }

  .nav-links {
  display: none;
  flex-direction: column;
  width: 100%;
  position: absolute;
  top: 50px;
  left: 0;
  background-color: #333;
  text-align: center;
  padding: 10px 0;
  z-index: 1000;
}

.show {
  display: flex !important;
}

  .nav-links button {
    display: block;
    width: 100%;
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #555;
    background: none;
    color: white;
  }

  .nav-links button:hover {
    background-color: #444;
  }
}

		.sign-out-btn:hover {
        background-color: #EE4B2B !important; /* Keep the red color even on hover */
      }
    </style>
  </head>
  <!-- Navbar -->
    <div class="navbar">
    <!-- Hamburger Menu Button -->
<button class="hamburger-menu" onclick="toggleMenu()">
  ☰ <!-- Unicode for the hamburger icon -->
</button>

<!-- Navigation Links -->
      <div class="logo">
        <img src="https://lh3.googleusercontent.com/pw/AP1GczPpTav2YZIazXoF0EEND4Qn68CLQed1Bz6qzpiJdWIaoUnRDd7t-j2TLiaYp2TjBkGaMvX0LaiHJXRRGgRt_FC_iEr92rEBoHmWaWAY5RsCzIbLtw=w2400" alt="Go to Home Page" onclick="redirectToMenuPage()" style="cursor: pointer;">
      </div>
      <div class="nav-links" id="nav-links">
        <button class="add-contact-btn" onclick="redirectToAddContactPage()">Thêm/Chỉnh sửa thông tin bệnh nhân</button>
        <button id="export-btn" onclick="exportToExcel()">Xuất file Excel</button>
        <button id="open-spreadsheet-btn" onclick="openSpreadsheet()">Mở Cơ Sở Dữ Liệu</button>
        <button class="print-btn" onclick="redirectToPrintPage()">In thông tin bệnh nhân</button>
      </div>
      <!-- User Profile Link, aligned to the right -->
      <div class="user-profile">
        <a href="#" onclick="redirectToUserPage()">
          <img src="https://lh3.googleusercontent.com/pw/AP1GczM9aPhk8Ohjr-yVBoDLDDjYTP7uVyIaxLJBcuAc_k2YGL1V1ZXcoqPiZYzI9HNjDabRzsEqpP7ZF2Pktfo4yDXtefEdfrkyfihDyCh7ZFeqGrqVNw=w2400" alt="User Profile" style="max-width: 40px;" />
          <span id="user-name">Loading...</span>
        </a>
        <button class="sign-out-btn" onclick="redirectToIndexPage()">Đăng Xuất</button>
      </div>
    </div>

  <body align="center">
  
<!--Header-->
<h2> Tra Cứu Thông Tin Bệnh Nhân </h2>
    <input type="text" id="id" placeholder="Nhập ID Bệnh Nhân" />
    <br>
    <input type="submit" class="btn btn-primary" value="Tra Cứu" onclick="info()" />
    
    <center>
      <div id='PrintDiv'> 
        <div id="result"></div>
      </div>
    </center>

    <script>
      function info() {
        let obj = document.querySelector('#id').value;
        let updateLocation = document.querySelector('#result');
        updateLocation.innerHTML = "Đang Tra Cứu...";

        function onFailure(error) {
          let warning = "<span style='color:red'>" + error + "</span>";
          updateLocation.innerHTML = warning;
        };

        function onSuccess(response) {
          let result = "<span style='color:#000;'>" + response + "</span>";
          updateLocation.innerHTML = result;
        };

        google.script.run.withFailureHandler(onFailure)
                         .withSuccessHandler(onSuccess)
                         .submitData(obj);
      }
    </script>

    <script>
      window.onload = function() {
      let navLinks = document.getElementById("nav-links");

      if (window.innerWidth > 768) {
        navLinks.style.display = "flex";
      } else {
        navLinks.style.display = "none";
      }

      google.script.run.withSuccessHandler(function(response) {
      console.log(response);
      document.getElementById('user-name').textContent = response;  
      }).getUserInfo();  

  loadAllContacts();
};
      function Print(DivID) {
        var iPrint = document.getElementById(DivID).innerHTML;
        var docprint = window.open("", "");
        docprint.document.open();
        docprint.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">');
        docprint.document.write('<head><meta name="viewport" content="width=device-width,initial-scale=1.0">');
        docprint.document.write('<title>Print</title>');
        docprint.document.write('<style type="text/css">@page {size:auto;margin:0.2em;}');
        docprint.document.write('table, td { border:1px solid grey; padding: 5px; font-size: 14px;} </style>');
        docprint.document.write('</head><center><body onLoad="self.print()">');
        docprint.document.write(iPrint);
        docprint.document.write('</body></center></html>');
        docprint.document.close();
        docprint.focus();
      }

     
    </script> 

    <input type="button" class="btn btn-secondary" name="btnprint" value="In Thông Tin Bệnh Nhân" onclick="Print('PrintDiv')" style="width:25%" />
    <footer>
    <small>
      Copyright © 2025 Đại Vũ Hoàng Triều. All Rights Reserved.
    </small>
  </footer>
  </body>
</html>
